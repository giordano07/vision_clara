<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || "Óptica COFICO" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Font Awesome for social icons %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <style>
      :root {
        --brand-primary: #1dbbb1; /* turquesa */
        --brand-dark: #2b3760;    /* azul profundo */
        --brand-header-light: #d8b4fe; /* violeta claro (un poco más oscuro) */
        --brand-bg: #f7fafc;
        --brand-text: #111827;
      }
      body { 
        background: var(--brand-bg); 
        color: var(--brand-text); 
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      a,
      a:hover,
      a:focus,
      a:active,
      a:visited {
        color: var(--brand-primary);
        text-decoration: none !important;
        transition: color 0.2s ease, text-decoration 0.2s ease;
      }
      a:hover,
      a:focus,
      a:active {
        color: var(--brand-dark);
      }
      main { flex: 1; }
      .site-header {
        /* Fallback color */
        background: var(--brand-header-light);
        /* Imagen de fondo */
        background-image: url('<%= asset_path("encabezado.jpg") %>');
        /* Vista original (cubre todo el header) */
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: var(--brand-dark);
        }
      .site-header a { color: var(--brand-dark); text-decoration: none; }
      .site-header a:hover { color: var(--brand-primary); text-decoration: none; }

      /* Footer */
      .site-footer {
        background: var(--brand-dark);
        color: var(--brand-primary);
        padding: 2rem 1rem;
        margin-top: auto;
      }
      .footer-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }
      .footer-address {
        font-size: 1.1rem;
        font-weight: 500;
        text-align: left;
        flex: 1;
      }
      .footer-social {
        display: flex;
        gap: 1.5rem;
        align-items: center;
      }
      .social-link {
        color: var(--brand-primary);
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: 500;
        transition: opacity 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }
      .social-link:hover {
        opacity: 0.8;
      }
      .social-icon {
        font-size: 2.5rem;
        color: var(--brand-primary);
      }
      @media (max-width: 768px) {
        .footer-content {
          flex-direction: column;
          gap: 1rem;
          text-align: center;
        }
        .footer-social {
          gap: 2rem;
        }
      }
      .site-header-inner {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 0;
        padding: 2rem 1rem;
      }
      .site-logo-wrap {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
      }
      .site-title {
        display: none;
        margin: 0;
      }
      .site-logo {
        height: 200px;
        width: auto;
        display: block;
      }
      @media (max-width: 767px) {
        .site-header {
          background: white;
          background-image: url('<%= asset_path("encabezado_mobile.jpg") %>');
          background-size: contain;
          background-repeat: no-repeat;
          background-position: center;
          min-height: 90px;
          padding: 0;
        }
        .site-header-inner {
          padding: 1rem 1rem 1.5rem;
        }
        .site-logo {
          height: 140px;
          display: none;
        }
      }
      @media (min-width: 768px) {
        .site-header-inner {
          flex-direction: row;
          padding: 60px;
        }
        .site-logo-wrap {
          flex: 0 0 22%;
          justify-content: flex-start;
        }
        .site-title {
          display: block;
          flex: 1 1 78%;
          font-weight: 800;
          font-size: 5.5rem;
          line-height: 1.05;
          text-align: center;
          transform: translateX(-22%);
          color: var(--brand-dark);
        }
        .site-title span:first-child { color: var(--brand-primary); }
        .site-title span:last-child { color: var(--brand-dark); }
        .site-logo {
          height: 320px;
        }
      }

      @media (min-width: 768px) and (max-width: 1023px) {
        .site-title {
          display: none;
        }
      }
      
      /* Flash Messages */
      .flash-message {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        max-width: 400px;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        animation: slideIn 0.3s ease-out;
        font-weight: 500;
      }
      
      .flash-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      
      .flash-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      
      .flash-content {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      
      .flash-content i {
        font-size: 1.2rem;
        flex-shrink: 0;
      }
      
      .flash-content span {
        flex: 1;
        line-height: 1.4;
      }
      
      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      
      @media (max-width: 768px) {
        .flash-message {
          top: 10px;
          right: 10px;
          left: 10px;
          max-width: none;
        }
      hr {
        display: block;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
        margin-left: auto;
        margin-right: auto;
        border-style: inset;
        border-width: 1px;
        width: 100%;
        border-bottom: 2px solid var(--brand-primary);
      }
      }
    </style>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <header class="site-header">
      <div class="site-header-inner">
        <div class="site-logo-wrap">
          <%= image_tag "logo.png", alt: "Óptica COFICO", class: "site-logo" %>
        </div>
        <h1 class="site-title"><span>Óptica</span><span style="font-weight:400;"> COFICO</span></h1>
      </div>
    </header>
    <hr>
    
    <!-- Flash Messages -->
    <% if notice %>
      <div class="flash-message flash-success">
        <div class="flash-content">
          <i class="fas fa-check-circle"></i>
          <span><%= notice %></span>
        </div>
      </div>
    <% end %>
    
    <% if alert %>
      <div class="flash-message flash-error">
        <div class="flash-content">
          <i class="fas fa-exclamation-circle"></i>
          <span><%= alert %></span>
        </div>
      </div>
    <% end %>
    
    <main class="container mx-auto mt-10 px-5">
      <%= yield %>
    </main>
    <footer class="site-footer">
      <div class="footer-content">
        <div class="footer-address">
          Dirección: Bedoya 409, Cofico, Ciudad de Córdoba
        </div>
        <div class="footer-social">
          <a href="https://wa.me/5493513033711" target="_blank" rel="noopener" class="social-link" title="WhatsApp: +54 9 351 303 3711">
            <i class="fab fa-whatsapp social-icon"></i>
          </a>
          <a href="https://facebook.com/p/Optica-cofico-100057705157885" target="_blank" rel="noopener" class="social-link" title="Facebook: Óptica Cofico">
            <i class="fab fa-facebook social-icon"></i>
          </a>
          <a href="https://instagram.com/OpticaCofico" target="_blank" rel="noopener" class="social-link" title="Instagram: Óptica Cofico">
            <i class="fab fa-instagram social-icon"></i>
          </a>
        </div>
      </div>
    </footer>
    
    <script>
      // Auto-hide flash messages after 5 seconds
      document.addEventListener('DOMContentLoaded', function() {
        const flashMessages = document.querySelectorAll('.flash-message');
        
        flashMessages.forEach(function(message) {
          setTimeout(function() {
            message.style.animation = 'slideOut 0.3s ease-in forwards';
            setTimeout(function() {
              message.remove();
            }, 300);
          }, 5000);
        });
      });
      
      // Add slideOut animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideOut {
          from {
            transform: translateX(0);
            opacity: 1;
          }
          to {
            transform: translateX(100%);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);
    </script>
  </body>
</html>
